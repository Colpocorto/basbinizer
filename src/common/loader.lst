Sjasm Z80 Assembler v0.42c - www.xl2s.tk             [2023.09.25 - 15:54:41]

loader.asm
Errors: 0

       1   00:0000                      	include common.asm
       1.  00:0000                      macro CHANGE_BORDER color
       2.  00:0000                    < 	push	bc
       3.  00:0000                    < 	ld	a,(#0006)
       4.  00:0000                    < 	inc	a
       5.  00:0000                    < 	ld	c,a
       6.  00:0000                    < 	ld	a,color
       7.  00:0000                    < 	di
       8.  00:0000                    < 	out	(c),a
       9.  00:0000                    < 	and	#c0
      10.  00:0000                    < 	out	(#aa),a	
      11.  00:0000                    < 	ld	a,87h	;register 7 + 80h
      12.  00:0000                    < 	out	(c),a
      13.  00:0000                    < 	pop	bc
      14.  00:0000                    < endmacro
      15.  00:0000                      macro CHANGE_BORDER_A
      16.  00:0000                    < 	push	bc
      17.  00:0000                    < 	push	af
      18.  00:0000                    < 	ld	a,(#0006)
      19.  00:0000                    < 	inc	a
      20.  00:0000                    < 	ld	c,a
      21.  00:0000                    < 	pop	af
      22.  00:0000                    < 	di
      23.  00:0000                    < 	out	(c),a
      24.  00:0000                    < 	and	#80
      25.  00:0000                    < 	out	(#aa),a	
      26.  00:0000                    < 	ld	a,87h	;register 7 + 80h
      27.  00:0000                    < 	out	(c),a
      28.  00:0000                    < 	pop	bc
      29.  00:0000                    < endmacro
      30.  00:0000                      
      31.  00:0000                      macro	BIOS_INTSLT	func
      32.  00:0000                    < 	ld	iy,(EXPTBL-1)
      33.  00:0000                    < 	ld	ix,func
      34.  00:0000                    < 	call	CALSLT
      35.  00:0000                    < endmacro
      36.  00:0000  (00:0200)           SECSIZE	equ	#0200
      37.  00:0000                      
      38.  00:0000  (00:0006)           RDVDP  EQU     0006H
      39.  00:0000  (00:0007)           WRVDP  EQU     0007H
      40.  00:0000  (00:000C)           RDSLT	equ	#000c
      41.  00:0000  (00:0014)           WRSLT	equ	#0014
      42.  00:0000  (00:001C)           CALSLT	equ	#001c
      43.  00:0000  (00:0020)           DCOMPR	equ	#0020
      44.  00:0000  (00:0024)           ENASLT	equ	#0024
      45.  00:0000  (00:002D)           BASVER	equ	#002d
      46.  00:0000  (00:0030)           CALLF	equ	#0030
      47.  00:0000  (00:0041)           DISSCR	equ	#0041
      48.  00:0000  (00:0044)           ENASCR	equ	#0044
      49.  00:0000  (00:0047)           WRTVDP	equ	#0047
      50.  00:0000  (00:004D)           WRTVRM	equ	#004D
      51.  00:0000  (00:0053)           SETWRT	equ	#0053
      52.  00:0000  (00:0056)           FILVRM	equ	#0056
      53.  00:0000  (00:005C)           LDIRVM	equ	#005c
      54.  00:0000  (00:0062)           CHGCLR	equ	#0062
      55.  00:0000  (00:006C)           INITXT	equ	#006C
      56.  00:0000  (00:006F)           INIT32	equ	#006f
      57.  00:0000  (00:0072)           INIGRP	equ	#0072
      58.  00:0000  (00:005F)           CHGMOD	equ	#005f
      59.  00:0000  (00:0090)           GICINI	equ	#0090
      60.  00:0000  (00:0093)           WRTPSG	equ	#0093
      61.  00:0000  (00:009F)           CHGET	equ	#009f
      62.  00:0000  (00:00C3)           CLS	equ	#00c3
      63.  00:0000  (00:00D5)           GTSTCK	equ	#00d5
      64.  00:0000  (00:00D8)           GTTRIG	equ	#00d8
      65.  00:0000  (00:00E1)           TAPION	equ	#00E1
      66.  00:0000  (00:00E4)           TAPIN	equ	#00E4
      67.  00:0000  (00:00E7)           TAPIOF	equ	#00E7
      68.  00:0000  (00:00F3)           STMOTR	equ	#00F3
      69.  00:0000  (00:0138)           RSLREG	equ	#0138
      70.  00:0000  (00:0141)           SNSMAT	equ	#0141
      71.  00:0000  (00:0145)           RSTPLT	equ	#0145
      72.  00:0000  (00:0156)           KILBUF	equ	#0156
      73.  00:0000  (00:015F)           EXTROM	equ	#015F
      74.  00:0000  (00:0180)           CHGCPU	equ	#0180
      75.  00:0000  (00:0183)           GETCPU	equ	#0183
      76.  00:0000  (00:73AC)           BASRUN  equ	#73ac
      77.  00:0000                      
      78.  00:0000                      
      79.  00:0000                      ;SUBROM CALLS
      80.  00:0000                      ;--------------
      81.  00:0000                      
      82.  00:0000  (00:0141)           INIPLT	equ	#0141
      83.  00:0000                      
      84.  00:0000                      
      85.  00:0000                      ;DISKROM CALLS
      86.  00:0000                      ;--------------
      87.  00:0000  (00:4010)           PHYDIO	equ	#4010
      88.  00:0000                      
      89.  00:0000  (00:F341)           RAMAD0	equ     #f341
      90.  00:0000  (00:F342)           RAMAD1	equ	#f342
      91.  00:0000  (00:F343)           RAMAD2  equ	#f343
      92.  00:0000  (00:F344)           RAMAD3	equ	#f344
      93.  00:0000  (00:F348)           MSTSLT	equ	#f348	;
      94.  00:0000                      
      95.  00:0000  (00:F341)           PG0_SLT	equ	RAMAD0
      96.  00:0000  (00:F342)           PG1_SLT	equ	RAMAD1
      97.  00:0000  (00:F343)           PG2_SLT	equ	RAMAD2
      98.  00:0000  (00:F344)           PG3_SLT	equ	RAMAD3
      99.  00:0000                      
     100.  00:0000  (00:F346)           DOSFLG	equ	#f346
     101.  00:0000  (00:F348)           DSKSLT	equ	#f348
     102.  00:0000  (00:F380)           HIMEM	equ	#f380
     103.  00:0000  (00:F672)           MEMSIZ  equ	#f672
     104.  00:0000  (00:F674)           STKTOP  equ #f674
     105.  00:0000  (00:F676)           TXTTAB  equ #f676
     106.  00:0000  (00:F69B)           FRETOP  equ #f69b
     107.  00:0000  (00:F6C2)           VARTAB  equ #f6c2
     108.  00:0000  (00:FC48)           BOTTOM  equ #fc48
     109.  00:0000  (00:FCAB)           CAPST   equ #fcab
     110.  00:0000  (00:FCAF)           SCRMOD	equ #FCAF
     111.  00:0000  (00:FD9A)           H.KEYI	equ	#fd9a
     112.  00:0000  (00:FD9F)           H.TIMI	equ	#fd9f
     113.  00:0000  (00:FEDA)           H.STKE  equ #feda
     114.  00:0000  (00:FFA7)           H.PHYD	equ #ffa7
     115.  00:0000  (00:FFAC)           H.FORM	equ #ffac
     116.  00:0000  (00:FFB1)           H.ERRO  equ #ffb1
     117.  00:0000                      
     118.  00:0000  (00:FCC1)           EXPTBL	equ	#fcc1
     119.  00:0000  (00:FCC5)           SLTTBL	equ	#fcc5
     120.  00:0000  (00:FFFF)           SBSLTR	equ	#ffff
     121.  00:0000  (00:F1E5)           ABTADR          equ     #f1e5
     122.  00:0000  (00:F273)           H.FATA          equ     #f273
     123.  00:0000  (00:F2E1)           DRIVE           equ     #f2e1
     124.  00:0000  (00:F323)           ERRADR	equ	#f323
     125.  00:0000  (00:F347)           NMBDRV          equ     #f347
     126.  00:0000  (00:F37D)           BDOS            equ     #f37d
     127.  00:0000                      
     128.  00:0000  (00:F380)           RDPRIM	EQU	#F380
     129.  00:0000  (00:F385)           WRPRIM	EQU	#F385
     130.  00:0000  (00:F38C)           CLPRIM	EQU	#F38C
     131.  00:0000  (00:F398)           CLPRM1	equ	#F398
     132.  00:0000  (00:F3B0)           LINLEN	EQU	#F3B0
     133.  00:0000  (00:F3B1)           CRTCNT	EQU	#F3B1
     134.  00:0000  (00:F3B3)           TXTNAM	EQU	#F3B3
     135.  00:0000  (00:F3B5)           TXTCOL	EQU	#F3B5
     136.  00:0000  (00:F3B7)           TXTCGP	EQU	#F3B7
     137.  00:0000  (00:F3B9)           TXTATR	EQU	#F3B9
     138.  00:0000  (00:F3BB)           TXTPAT	EQU	#F3BB
     139.  00:0000  (00:F3BD)           T32NAM	EQU	#F3BD
     140.  00:0000  (00:F3BF)           T32COL	EQU	#F3BF
     141.  00:0000  (00:F3C1)           T32CGP	equ	#F3C1
     142.  00:0000  (00:F3C3)           T32ATR	equ	#F3C3
     143.  00:0000  (00:F3C5)           T32PAT	equ	#F3C5
     144.  00:0000  (00:F3C7)           GRPNAM	EQU	#F3C7
     145.  00:0000  (00:F3C9)           GRPCOL	EQU	#F3C9
     146.  00:0000  (00:F3CB)           GRPCGP	EQU	#F3CB
     147.  00:0000  (00:F3CD)           GRPATR	EQU	#F3CD
     148.  00:0000  (00:F3CF)           GRPPAT	EQU	#F3CF
     149.  00:0000  (00:F3D1)           MLTNAM	EQU	#F3D1
     150.  00:0000  (00:F3D3)           MLTCOL	EQU	#F3D3
     151.  00:0000  (00:F3D5)           MLTCGP	EQU	#F3D5
     152.  00:0000  (00:F3D7)           MLTATR	EQU	#F3D7
     153.  00:0000  (00:F3D9)           MLTPAT	EQU	#F3D9
     154.  00:0000  (00:F3DB)           CLIKSW	EQU	0F3DBH
     155.  00:0000  (00:F3DC)           CSRY	EQU	0F3DCH
     156.  00:0000  (00:F3DD)           CSRX	EQU	0F3DDH
     157.  00:0000  (00:F3DE)           CNSDFG	EQU	0F3DEH
     158.  00:0000  (00:F3DF)           RG0SAV	EQU	0F3DFH
     159.  00:0000  (00:F3E0)           RG1SAV	EQU	0F3E0H
     160.  00:0000  (00:F3E7)           STATFL	EQU	0F3E7H
     161.  00:0000  (00:F3E8)           TRGFLG	EQU	0F3E8H
     162.  00:0000  (00:F3E9)           FORCLR	EQU	0F3E9H
     163.  00:0000  (00:F3EA)           BAKCLR	EQU	0F3EAH
     164.  00:0000  (00:F3EB)           BDRCLR	EQU	0F3EBH
     165.  00:0000  (00:F3F2)           ATRBYT	EQU	0F3F2H
     166.  00:0000  (00:F3F3)           QUEUES	EQU	0F3F3H
     167.  00:0000  (00:F3F6)           SCNCNT	EQU	0F3F6H
     168.  00:0000  (00:F3F7)           REPCNT	EQU	0F3F7H
     169.  00:0000  (00:F3F8)           PUTPNT	EQU	0F3F8H
     170.  00:0000  (00:F3FA)           GETPNT	EQU	0F3FAH
     171.  00:0000  (00:F406)           LOW.	equ	0F406H
     172.  00:0000  (00:F408)           HIGH.	equ	0F408H
     173.  00:0000  (00:F40A)           HEADER	equ	0F40AH
     174.  00:0000  (00:F40B)           ASPCT1	EQU	0F40BH
     175.  00:0000  (00:F40D)           ASPCT2	EQU	0F40DH
     176.  00:0000  (00:F415)           LPTPOS	EQU	0F415H
     177.  00:0000  (00:F416)           PRTFLG	EQU	0F416H
     178.  00:0000  (00:F417)           NTMSXP	EQU	0F417H
     179.  00:0000  (00:F418)           RAWPRT	EQU	0F418H
     180.  00:0000  (00:F41C)           CURLIN	EQU	0F41CH
     181.  00:0000  (00:F55D)           BUFMIN	EQU	0F55DH
     182.  00:0000  (00:F55E)           BUF	EQU	0F55EH
     183.  00:0000  (00:F661)           TTYPOS	EQU	0F661H
     184.  00:0000  (00:F6AA)           AUTFLG	EQU	0F6AAH
     185.  00:0000  (00:F6B1)           SAVSTK	EQU	0F6B1H
     186.  00:0000  (00:F864)           PTRFIL	EQU	0F864H
     187.  00:0000  (00:F866)           FILNAM	EQU	0F866H
     188.  00:0000  (00:F87F)           FNKSTR	EQU	0F87FH
     189.  00:0000  (00:F91F)           CGPNT	EQU	0F91FH
     190.  00:0000  (00:F922)           NAMBAS	EQU	0F922H
     191.  00:0000  (00:F924)           CGPBAS	EQU	0F924H
     192.  00:0000  (00:F926)           PATBAS	EQU	0F926H
     193.  00:0000  (00:F928)           ATRBAS	EQU	0F928H
     194.  00:0000  (00:F92A)           CLOC	EQU	0F92AH
     195.  00:0000  (00:F92C)           CMASK	EQU	0F92CH
     196.  00:0000  (00:F942)           CSAVEA	EQU	0F942H
     197.  00:0000  (00:F944)           CSAVEM	EQU	0F944H
     198.  00:0000  (00:F971)           QUEBAK	EQU	0F971H
     199.  00:0000  (00:F975)           VOICAQ	EQU	0F975H
     200.  00:0000  (00:FAF6)           ACPAGE	EQU	0FAF6H
     201.  00:0000  (00:FAF8)           EXBRSA	EQU	0FAF8H
     202.  00:0000  (00:FAF9)           CHRCNT	EQU	0FAF9H
     203.  00:0000  (00:FAFC)           MODE	EQU	0FAFCH
     204.  00:0000  (00:FAFE)           XSAVE	EQU	0FAFEH
     205.  00:0000  (00:FB02)           LOGOPR	EQU	0FB02H
     206.  00:0000  (00:FB20)           HOKVLD	EQU	0FB20H
     207.  00:0000  (00:FB38)           VOICEN	EQU	0FB38H
     208.  00:0000  (00:FB3E)           QUEUEN	EQU	0FB3EH
     209.  00:0000  (00:FB3F)           MUSICF	EQU	0FB3FH
     210.  00:0000  (00:FB40)           PLYCNT	EQU	0FB40H
     211.  00:0000  (00:FB41)           VCBA	EQU	0FB41H
     212.  00:0000  (00:FB66)           VCBB	EQU	0FB66H
     213.  00:0000  (00:FB8B)           VCBC	EQU	0FB8BH
     214.  00:0000  (00:FBCE)           FNKFLG	EQU	0FBCEH
     215.  00:0000  (00:FC4C)           TRPTBL	EQU	0FC4CH
     216.  00:0000  (00:FBB0)           ENSTOP	EQU	0FBB0H
     217.  00:0000  (00:FBB1)           BASROM	EQU	0FBB1H
     218.  00:0000  (00:FBB2)           LINTTB	EQU	0FBB2H
     219.  00:0000  (00:FBCA)           FSTPOS	EQU	0FBCAH
     220.  00:0000  (00:FBCC)           CURSAV	EQU	0FBCCH
     221.  00:0000  (00:FBCD)           FNKSWI	EQU	0FBCDH
     222.  00:0000  (00:FBD8)           ONGSBF	EQU	0FBD8H
     223.  00:0000  (00:FBD9)           CLIKFL	EQU	0FBD9H
     224.  00:0000  (00:FBDA)           OLDKEY	EQU	0FBDAH
     225.  00:0000  (00:FBE5)           NEWKEY	EQU	0FBE5H
     226.  00:0000  (00:FBF0)           KEYBUF	EQU	0FBF0H
     227.  00:0000  (00:FC18)           LINWRK	EQU	0FC18H
     228.  00:0000  (00:FC40)           PATWRK	EQU	0FC40H
     229.  00:0000  (00:FC9B)           INTFLG	EQU	0FC9BH
     230.  00:0000  (00:FC9C)           PADY	EQU	0FC9CH
     231.  00:0000  (00:FC9D)           PADX	EQU	0FC9DH
     232.  00:0000  (00:FC9E)           JIFFY	EQU	0FC9EH
     233.  00:0000  (00:FCA0)           INTVAL	EQU	0FCA0H
     234.  00:0000  (00:FCA2)           INTCNT	EQU	0FCA2H
     235.  00:0000  (00:FCA4)           LOWLIM	equ	0FCA4H
     236.  00:0000  (00:FCA5)           WINWID	equ	0FCA5H
     237.  00:0000  (00:FCA6)           GRPHED	EQU	0FCA6H
     238.  00:0000  (00:FCA7)           ESCCNT	EQU	0FCA7H
     239.  00:0000  (00:FCA8)           INSFLG	EQU	0FCA8H
     240.  00:0000  (00:FCA9)           CSRSW	EQU	0FCA9H
     241.  00:0000  (00:FCAA)           CSTYLE	EQU	0FCAAH
     242.  00:0000                      ;CAPST	EQU	0FCABH
     243.  00:0000  (00:FCAC)           KANAST	EQU	0FCACH
     244.  00:0000  (00:FCAD)           KANAMD	EQU	0FCADH
     245.  00:0000                      ;SCRMOD	EQU	0FCAFH
     246.  00:0000  (00:FCB0)           OLDSCR	EQU	0FCB0H
     247.  00:0000  (00:FCB1)           CASPRV	EQU	0FCB1H
     248.  00:0000  (00:FCB2)           BDRATR	EQU	0FCB2H
     249.  00:0000  (00:FCB7)           GRPACX	EQU	0FCB7H
     250.  00:0000  (00:FCB9)           GRPACY	EQU	0FCB9H
     251.  00:0000                      ;EXPTBL	EQU	0FCC1H
     252.  00:0000                      ;SLTTBL	EQU	0FCC5H
     253.  00:0000  (00:FCC9)           SLTATR	EQU	0FCC9H
     254.  00:0000                      
     255.  00:0000                      ;H.KEYI	EQU	0FD9AH
     256.  00:0000                      ;H.TIMI	EQU	0FD9FH
     257.  00:0000  (00:FDA4)           H.CHPU	EQU	0FDA4H
     258.  00:0000  (00:FDA9)           H.DSPC	EQU	0FDA9H
     259.  00:0000  (00:FDAE)           H.ERAC	EQU	0FDAEH
     260.  00:0000  (00:FDB3)           H.DSPF	EQU	0FDB3H
     261.  00:0000  (00:FDB8)           H.ERAF	EQU	0FDB8H
     262.  00:0000  (00:FDBD)           H.TOTE	EQU	0FDBDH
     263.  00:0000  (00:FDC2)           H.CHGE	EQU	0FDC2H
     264.  00:0000  (00:FDC7)           H.INIP	EQU	0FDC7H
     265.  00:0000  (00:FDCC)           H.KEYC	EQU	0FDCCH
     266.  00:0000  (00:FDD1)           H.KEYA	EQU	0FDD1H
     267.  00:0000  (00:FDD6)           H.NMI	EQU	0FDD6H
     268.  00:0000  (00:FDDB)           H.PINL	EQU	0FDDBH
     269.  00:0000  (00:FDE0)           H.QINL	EQU	0FDE0H
     270.  00:0000  (00:FDE5)           H.INLI	EQU	0FDE5H
     271.  00:0000  (00:FEDF)           H.ISFL	EQU	0FEDFH
     272.  00:0000  (00:FEE4)           H.OUTD	EQU	0FEE4H
     273.  00:0000  (00:FF75)           H.OKNO	EQU	0FF75H
     274.  00:0000  (00:FF75)           H.MDIN	EQU	0FF75H
     275.  00:0000  (00:FF93)           H.MDTM	EQU	0FF93H
     276.  00:0000                      ;H.PHYD	EQU	0FFA7H
     277.  00:0000                      ;H.FORM	EQU	0FFACH
     278.  00:0000  (00:FFB6)           H.LPTO	EQU	0FFB6H
     279.  00:0000  (00:FFBB)           H.LPTS	EQU	0FFBBH
     280.  00:0000  (00:FFCA)           EXTBIO	EQU	0FFCAH
     281.  00:0000  (00:FFE7)           RG8SAV	EQU	0FFE7H
     282.  00:0000  (00:FFE7)           RG08SAV	EQU	0FFE7h	;	System saves the byte written to the register R#08 here, Used by VDP(9). (MSX2~)
     283.  00:0000  (00:FFE8)           RG09SAV	EQU	0FFE8h	;	System saves the byte written to the register R#09 here, Used by VDP(10). (MSX2~)
     284.  00:0000  (00:FFE9)           RG10SAV	EQU	0FFE9h	;System saves the byte written to the register R#10 here, Used by VDP(11). (MSX2~)
     285.  00:0000  (00:FFEA)           RG11SAV	EQU	0FFEAh	;System saves the byte written to the register R#11 here, Used by VDP(12). (MSX2~)
     286.  00:0000  (00:FFEB)           RG12SAV	EQU	0FFEBh	;System saves the byte written to the register R#12 here, Used by VDP(13). (MSX2~)
     287.  00:0000  (00:FFEC)           RG13SAV	EQU	0FFECh	;System saves the byte written to the register R#13 here, Used by VDP(14). (MSX2~)
     288.  00:0000  (00:FFED)           RG14SAV	EQU	0FFEDh	;System saves the byte written to the register R#14 here, Used by VDP(15). (MSX2~)
     289.  00:0000  (00:FFEE)           RG15SAV	EQU	0FFEEh	;System saves the byte written to the register R#15 here, Used by VDP(16). (MSX2~)
     290.  00:0000  (00:FFEF)           RG16SAV	EQU	0FFEFh	;System saves the byte written to the register R#16 here, Used by VDP(17). (MSX2~)
     291.  00:0000  (00:FFF0)           RG17SAV	EQU	0FFF0h	;System saves the byte written to the register R#17 here, Used by VDP(18). (MSX2~)
     292.  00:0000  (00:FFF1)           RG18SAV	EQU	0FFF1h	;System saves the byte written to the register R#18 here, Used by VDP(19). (MSX2~)
     293.  00:0000  (00:FFF2)           RG19SAV	EQU	0FFF2h	;System saves the byte written to the register R#19 here, Used by VDP(20). (MSX2~)
     294.  00:0000  (00:FFF3)           RG20SAV	EQU	0FFF3h	;System saves the byte written to the register R#20 here, Used by VDP(21). (MSX2~)
     295.  00:0000  (00:FFF4)           RG21SAV	EQU	0FFF4h	;System saves the byte written to the register R#21 here, Used by VDP(22). (MSX2~)
     296.  00:0000  (00:FFF5)           RG22SAV	EQU	0FFF5h	;System saves the byte written to the register R#22 here, Used by VDP(23). (MSX2~)
     297.  00:0000  (00:FFF6)           RG23SAV	EQU	0FFF6h	;System saves the byte written to the register R#23 here, Used by VDP(24). (MSX2~)
     298.  00:0000  (00:FFF7)           MINROM	EQU	0FFF7h	;Slot address of Main-ROM. Use EXPTBL+0 to know slot ID of the internal Main-ROM. (MSX2~)
     299.  00:0000  (00:FFFA)           RG25SAV	EQU	0FFFAh	;System saves the byte written to the register R#25 here, Used by VDP(26). (MSX2+~)
     300.  00:0000  (00:FFFB)           RG26SAV	EQU	0FFFBh	;System saves the byte written to the register R#26 here, Used by VDP(27). (MSX2+~)
     301.  00:0000  (00:FFFC)           RG27SAV	EQU	0FFFCh	;System saves the byte written to the register R#27 here, Used by VDP(28). (MSX2+~)
     302.  00:0000                      
       2   00:0000                      	
       3   00:0000                      
       4   00:0000  (00:8000)           BASPRG	equ #8000
       5   00:0000  (00:8000)           buffer	equ	#8000
       6   00:0000                      
       7   00:0000  (00:F000)           JMPLDR	equ	#F000
       8   00:0000                      
       9   00:0000  (00:4000)           LAUNCH	equ	#4000
      10   00:0000                      
      11   00:0000  (00:F975)           CRTSLT	equ	#f975
      12   00:0000  (00:F976)           PG0SLT	equ CRTSLT+1
      13   00:0000  (00:F977)           PG1SLT	equ PG0SLT+1
      14   00:0000  (00:F978)           PG2SLT	equ	PG1SLT+1
      15   00:0000  (00:F979)           DZX0	equ	PG2SLT+1
      16   00:0000                      
      17   00:0000                      define	CASHDR	#1F,#A6,#DE,#BA,#CC,#13,#7D,#74
      18   00:0000                      
      19   00:0000  (00:F975)           LDRSTART	equ	#F975
      20   00:0000  (00:F975)           LDREXEC		equ LDRSTART
      21   00:0000                      
      22   00:0000                      	output	loader.dat
      23   00:F975                      	
      24   00:F975                      	db	CASHDR
      24   00:F975  1F A6 DE BA CC 13 7D 74 
      25   00:F97D  D0 (10)             	ds	10,#D0	;binary file signature
      26   00:F987  47 41 4D 45 20 20   	db	"GAME  "	;cas file name
      27   00:F98D                      	db	CASHDR
      27   00:F98D  1F A6 DE BA CC 13 7D 74 
      28   00:F995  75 F9               	dw	LOADER.LDRSTART
      29   00:F997  F4 F9               	dw	LOADER.LDREND - 1
      30   00:F999  75 F9               	dw	LDREXEC
      31   00:F99B                      
      32   00:F99B                      	module	LOADER
      33   00:F99B                      	org	LDRSTART
      34   00:F975                      LDRSTART:
      35   00:F975  F3                  	di
      36   00:F976  3E C9               	ld	a,#c9
      37   00:F978  32 9A FD            	ld	(H.KEYI),a
      38   00:F97B  32 9F FD            	ld	(H.TIMI),a
      39   00:F97E                      
      40   00:F97E                      
      41   00:F97E  21 00 80            	ld	hl,BASPRG
      42   00:F981  01 00 00            	ld	bc,DAT_80E-DAT_80
      43   00:F984  CD B1 F9            	call	LOAD
      44   00:F987                      	;HL contains the top address
      45   00:F987                      
      46   00:F987  F3                  	di
      47   00:F988  22 C2 F6            	ld	(VARTAB),hl
      48   00:F98B  21 01 80            	ld	hl,BASPRG+1
      49   00:F98E  22 76 F6            	ld	(TXTTAB),hl
      50   00:F991  2B                  	dec	hl
      51   00:F992  22 48 FC            	ld	(BOTTOM),hl
      52   00:F995                      
      53   00:F995  3E 0F               	ld	a,15
      54   00:F997  21 E9 F3            	ld	hl,FORCLR
      55   00:F99A  77                  	ld	(hl),a
      56   00:F99B  3E 01               	ld	a,1
      57   00:F99D  23                  	inc	hl
      58   00:F99E  77                  	ld	(hl),a
      59   00:F99F  23                  	inc	hl
      60   00:F9A0  77                  	ld	(hl),a
      61   00:F9A1  CD 62 00            	call	CHGCLR
      62   00:F9A4                      
      63   00:F9A4  CD 6C 00            	call	INITXT
      64   00:F9A7  AF                  	xor	a
      65   00:F9A8  32 00 80            	ld	(BASPRG),a
      66   00:F9AB                      
      67   00:F9AB  C3 AC 73            	jp	BASRUN
      68   00:F9AE                      
      69   00:F9AE                      /*
      70   00:F9AE                    ~     ld (VARTAB),hl	;#f6c2	#8003 -	#8713	= #710 (BAS size - 3)
      71   00:F9AE                    ~     ld  hl,BASPRG
      72   00:F9AE                    ~     ld  (TXTTAB),hl	;#f676	#8001	#8001
      73   00:F9AE                    ~ 	dec	hl
      74   00:F9AE                    ~ 	ld	(BOTTOM),hl	;#fc48	#8000	#8000
      75   00:F9AE                    ~ 	#8000 <- #00
      76   00:F9AE                    ~ */
      77   00:F9AE                      
      78   00:F9AE                      
      79   00:F9AE  C3 00 40            	jp	LAUNCH
      80   00:F9B1                      
      81   00:F9B1                      LOAD:
      82   00:F9B1  F3                  	di
      83   00:F9B2  C5                  	push	bc	;counter
      84   00:F9B3  E5                  	push	hl	;destination
      85   00:F9B4                      	;patch border routine
      86   00:F9B4  3A 07 00            	ld	a,(#0007)
      87   00:F9B7  3C                  	inc	a
      88   00:F9B8  32 EF F9            	ld	(changeBorderPatch01+1),a
      89   00:F9BB  32 F3 F9            	ld	(changeBorderPatch02+1),a
      90   00:F9BE                      
      91   00:F9BE                      .loadHdr	
      92   00:F9BE  CD E1 00            	call	TAPION
      93   00:F9C1  38 FB               	jr	c,.loadHdr
      94   00:F9C3                      .loop:	
      95   00:F9C3  CD E4 00            	call	TAPIN
      96   00:F9C6  38 FB               	jr	c,.loop
      97   00:F9C8  E1                  	pop	hl
      98   00:F9C9  77                  	ld	(hl),a
      99   00:F9CA  23                  	inc	hl
     100   00:F9CB  3A EC F9            	ld	a,(COL_LOAD)
     101   00:F9CE  EE 06               	xor	%00000110
     102   00:F9D0  32 EC F9            	ld	(COL_LOAD),A
     103   00:F9D3  CD ED F9            	call	changeBorder
     104   00:F9D6  C1                  	pop	bc
     105   00:F9D7  0B                  	dec	bc
     106   00:F9D8  79                  	ld	a,c
     107   00:F9D9  B0                  	or	b
     108   00:F9DA  C5                  	push	bc
     109   00:F9DB  E5                  	push	hl
     110   00:F9DC  20 E5               	jr	nz,.loop
     111   00:F9DE  E1                  	pop	hl
     112   00:F9DF  C1                  	pop	bc
     113   00:F9E0  CD E7 00            	call	TAPIOF
     114   00:F9E3  AF                  	xor	a
     115   00:F9E4  CD F3 00            	call	STMOTR
     116   00:F9E7  3E 01               	ld	a,1
     117   00:F9E9  C3 ED F9            	jp	changeBorder
     118   00:F9EC                      	;ret
     119   00:F9EC                      COL_LOAD:
     120   00:F9EC  06                  	db	%00000110
     121   00:F9ED                      
     122   00:F9ED                      changeBorder:
     123   00:F9ED  F3                  	di
     124   00:F9EE                      changeBorderPatch01:
     125   00:F9EE  D3 99               	out	(#99),a
     126   00:F9F0                      
     127   00:F9F0  3E 87               	ld	a,87h	;register 7 + 80h
     128   00:F9F2                      changeBorderPatch02:	
     129   00:F9F2  D3 99               	out	(#99),a
     130   00:F9F4  C9                  	ret
     131   00:F9F5                      		
     132   00:F9F5                      LDREND:
     133   00:F9F5                      
     134   00:F9F5                      	endmodule
     135   00:F9F5                      
     136   00:F9F5                      	;-----------------TAPE BLOCKS-----------------------
     137   00:F9F5                      	db	CASHDR
     137   00:F9F5  1F A6 DE BA CC 13 7D 74 
     138   00:F9FD                      DAT_80:	
     139   00:F9FD                      	//incbin "#8000.zx0"
     140   00:F9FD                      DAT_80E:
     141   00:F9FD                      

    LABELS
-------------------------------------------------
00:00000200 X SECSIZE
00:00000006 X RDVDP
00:00000007 X WRVDP
00:0000000C X RDSLT
00:00000014 X WRSLT
00:0000001C X CALSLT
00:00000020 X DCOMPR
00:00000024 X ENASLT
00:0000002D X BASVER
00:00000030 X CALLF
00:00000041 X DISSCR
00:00000044 X ENASCR
00:00000047 X WRTVDP
00:0000004D X WRTVRM
00:00000053 X SETWRT
00:00000056 X FILVRM
00:0000005C X LDIRVM
00:00000062   CHGCLR
00:0000006C   INITXT
00:0000006F X INIT32
00:00000072 X INIGRP
00:0000005F X CHGMOD
00:00000090 X GICINI
00:00000093 X WRTPSG
00:0000009F X CHGET
00:000000C3 X CLS
00:000000D5 X GTSTCK
00:000000D8 X GTTRIG
00:000000E1   TAPION
00:000000E4   TAPIN
00:000000E7   TAPIOF
00:000000F3   STMOTR
00:00000138 X RSLREG
00:00000141 X SNSMAT
00:00000145 X RSTPLT
00:00000156 X KILBUF
00:0000015F X EXTROM
00:00000180 X CHGCPU
00:00000183 X GETCPU
00:000073AC   BASRUN
00:00000141 X INIPLT
00:00004010 X PHYDIO
00:0000F341   RAMAD0
00:0000F342   RAMAD1
00:0000F343   RAMAD2
00:0000F344   RAMAD3
00:0000F348 X MSTSLT
00:0000F341 X PG0_SLT
00:0000F342 X PG1_SLT
00:0000F343 X PG2_SLT
00:0000F344 X PG3_SLT
00:0000F346 X DOSFLG
00:0000F348 X DSKSLT
00:0000F380 X HIMEM
00:0000F672 X MEMSIZ
00:0000F674 X STKTOP
00:0000F676   TXTTAB
00:0000F69B X FRETOP
00:0000F6C2   VARTAB
00:0000FC48   BOTTOM
00:0000FCAB X CAPST
00:0000FCAF X SCRMOD
00:0000FD9A   H.KEYI
00:0000FD9F   H.TIMI
00:0000FEDA X H.STKE
00:0000FFA7 X H.PHYD
00:0000FFAC X H.FORM
00:0000FFB1 X H.ERRO
00:0000FCC1 X EXPTBL
00:0000FCC5 X SLTTBL
00:0000FFFF X SBSLTR
00:0000F1E5 X ABTADR
00:0000F273 X H.FATA
00:0000F2E1 X DRIVE
00:0000F323 X ERRADR
00:0000F347 X NMBDRV
00:0000F37D X BDOS
00:0000F380 X RDPRIM
00:0000F385 X WRPRIM
00:0000F38C X CLPRIM
00:0000F398 X CLPRM1
00:0000F3B0 X LINLEN
00:0000F3B1 X CRTCNT
00:0000F3B3 X TXTNAM
00:0000F3B5 X TXTCOL
00:0000F3B7 X TXTCGP
00:0000F3B9 X TXTATR
00:0000F3BB X TXTPAT
00:0000F3BD X T32NAM
00:0000F3BF X T32COL
00:0000F3C1 X T32CGP
00:0000F3C3 X T32ATR
00:0000F3C5 X T32PAT
00:0000F3C7 X GRPNAM
00:0000F3C9 X GRPCOL
00:0000F3CB X GRPCGP
00:0000F3CD X GRPATR
00:0000F3CF X GRPPAT
00:0000F3D1 X MLTNAM
00:0000F3D3 X MLTCOL
00:0000F3D5 X MLTCGP
00:0000F3D7 X MLTATR
00:0000F3D9 X MLTPAT
00:0000F3DB X CLIKSW
00:0000F3DC X CSRY
00:0000F3DD X CSRX
00:0000F3DE X CNSDFG
00:0000F3DF X RG0SAV
00:0000F3E0 X RG1SAV
00:0000F3E7 X STATFL
00:0000F3E8 X TRGFLG
00:0000F3E9   FORCLR
00:0000F3EA X BAKCLR
00:0000F3EB X BDRCLR
00:0000F3F2 X ATRBYT
00:0000F3F3 X QUEUES
00:0000F3F6 X SCNCNT
00:0000F3F7 X REPCNT
00:0000F3F8 X PUTPNT
00:0000F3FA X GETPNT
00:0000F406 X LOW.
00:0000F408 X HIGH.
00:0000F40A X HEADER
00:0000F40B X ASPCT1
00:0000F40D X ASPCT2
00:0000F415 X LPTPOS
00:0000F416 X PRTFLG
00:0000F417 X NTMSXP
00:0000F418 X RAWPRT
00:0000F41C X CURLIN
00:0000F55D X BUFMIN
00:0000F55E X BUF
00:0000F661 X TTYPOS
00:0000F6AA X AUTFLG
00:0000F6B1 X SAVSTK
00:0000F864 X PTRFIL
00:0000F866 X FILNAM
00:0000F87F X FNKSTR
00:0000F91F X CGPNT
00:0000F922 X NAMBAS
00:0000F924 X CGPBAS
00:0000F926 X PATBAS
00:0000F928 X ATRBAS
00:0000F92A X CLOC
00:0000F92C X CMASK
00:0000F942 X CSAVEA
00:0000F944 X CSAVEM
00:0000F971 X QUEBAK
00:0000F975 X VOICAQ
00:0000FAF6 X ACPAGE
00:0000FAF8 X EXBRSA
00:0000FAF9 X CHRCNT
00:0000FAFC X MODE
00:0000FAFE X XSAVE
00:0000FB02 X LOGOPR
00:0000FB20 X HOKVLD
00:0000FB38 X VOICEN
00:0000FB3E X QUEUEN
00:0000FB3F X MUSICF
00:0000FB40 X PLYCNT
00:0000FB41 X VCBA
00:0000FB66 X VCBB
00:0000FB8B X VCBC
00:0000FBCE X FNKFLG
00:0000FC4C X TRPTBL
00:0000FBB0 X ENSTOP
00:0000FBB1 X BASROM
00:0000FBB2 X LINTTB
00:0000FBCA X FSTPOS
00:0000FBCC X CURSAV
00:0000FBCD X FNKSWI
00:0000FBD8 X ONGSBF
00:0000FBD9 X CLIKFL
00:0000FBDA X OLDKEY
00:0000FBE5 X NEWKEY
00:0000FBF0 X KEYBUF
00:0000FC18 X LINWRK
00:0000FC40 X PATWRK
00:0000FC9B X INTFLG
00:0000FC9C X PADY
00:0000FC9D X PADX
00:0000FC9E X JIFFY
00:0000FCA0 X INTVAL
00:0000FCA2 X INTCNT
00:0000FCA4 X LOWLIM
00:0000FCA5 X WINWID
00:0000FCA6 X GRPHED
00:0000FCA7 X ESCCNT
00:0000FCA8 X INSFLG
00:0000FCA9 X CSRSW
00:0000FCAA X CSTYLE
00:0000FCAC X KANAST
00:0000FCAD X KANAMD
00:0000FCB0 X OLDSCR
00:0000FCB1 X CASPRV
00:0000FCB2 X BDRATR
00:0000FCB7 X GRPACX
00:0000FCB9 X GRPACY
00:0000FCC9 X SLTATR
00:0000FDA4 X H.CHPU
00:0000FDA9 X H.DSPC
00:0000FDAE X H.ERAC
00:0000FDB3 X H.DSPF
00:0000FDB8 X H.ERAF
00:0000FDBD X H.TOTE
00:0000FDC2 X H.CHGE
00:0000FDC7 X H.INIP
00:0000FDCC X H.KEYC
00:0000FDD1 X H.KEYA
00:0000FDD6 X H.NMI
00:0000FDDB X H.PINL
00:0000FDE0 X H.QINL
00:0000FDE5 X H.INLI
00:0000FEDF X H.ISFL
00:0000FEE4 X H.OUTD
00:0000FF75 X H.OKNO
00:0000FF75 X H.MDIN
00:0000FF93 X H.MDTM
00:0000FFB6 X H.LPTO
00:0000FFBB X H.LPTS
00:0000FFCA X EXTBIO
00:0000FFE7 X RG8SAV
00:0000FFE7 X RG08SAV
00:0000FFE8 X RG09SAV
00:0000FFE9 X RG10SAV
00:0000FFEA X RG11SAV
00:0000FFEB X RG12SAV
00:0000FFEC X RG13SAV
00:0000FFED X RG14SAV
00:0000FFEE X RG15SAV
00:0000FFEF X RG16SAV
00:0000FFF0 X RG17SAV
00:0000FFF1 X RG18SAV
00:0000FFF2 X RG19SAV
00:0000FFF3 X RG20SAV
00:0000FFF4 X RG21SAV
00:0000FFF5 X RG22SAV
00:0000FFF6 X RG23SAV
00:0000FFF7 X MINROM
00:0000FFFA X RG25SAV
00:0000FFFB X RG26SAV
00:0000FFFC X RG27SAV
00:00008000   BASPRG
00:00008000 X buffer
00:0000F000 X JMPLDR
00:00004000   LAUNCH
00:0000F975   CRTSLT
00:0000F976   PG0SLT
00:0000F977   PG1SLT
00:0000F978   PG2SLT
00:0000F979 X DZX0
00:0000F975   LDRSTART
00:0000F975   LDREXEC
00:0000F975   LOADER.LDRSTART
00:0000F9B1   LOADER.LOAD
00:0000F9BE   LOADER.LOAD.loadHdr
00:0000F9C3   LOADER.LOAD.loop
00:0000F9EC   LOADER.COL_LOAD
00:0000F9ED   LOADER.changeBorder
00:0000F9EE   LOADER.changeBorderPatch01
00:0000F9F2   LOADER.changeBorderPatch02
00:0000F9F5   LOADER.LDREND
00:0000F9FD   DAT_80
00:0000F9FD   DAT_80E


 Output: loader.out
-------------------------------------------------

 Page: 00
  Org: 0000F975  Size: *  Used: 00000000

    No output

 Output: loader.dat
-------------------------------------------------

 Page: 00
  Org: 0000F975  Size: *  Used: 000000AE

   Address   Length Align   Label
   0000F975     174         LOADER.LDRSTART
